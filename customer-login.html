<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Müşteri Giriş | Cepterandevu</title>

    <style>
        :root {
            --bg: #050816;
            --card: #101528;
            --accent: #22c55e;
            --accent-strong: #16a34a;
            --text: #f9fafb;
            --muted: #9ca3af;
            --border: rgba(148,163,184,0.4);
            --radius-xl: 24px;
            --shadow-soft: 0 18px 45px rgba(15,23,42,0.85);
        }

        * {margin:0;padding:0;box-sizing:border-box;}

        body {
            font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
            background: radial-gradient(circle at top,#111827,#020617 55%);
            color: var(--text);
            min-height:100vh;
            display:flex;
            justify-content:center;
            align-items:flex-start;
            padding:40px 20px;
        }

        .form-shell {
            width:100%;
            max-width:420px;
            background:rgba(15,23,42,0.92);
            padding:28px;
            border-radius:var(--radius-xl);
            border:1px solid var(--border);
            box-shadow:var(--shadow-soft);
            backdrop-filter:blur(10px);
        }

        h1 {font-size:22px;margin-bottom:6px;}
        p.sub {font-size:12px;color:var(--muted);margin-bottom:20px;}

        label {
            font-size:12px;color:var(--muted);
            margin-bottom:4px;display:block;
        }

        input {
            width:100%;padding:10px 14px;
            background:#0b1120;border:1px solid var(--border);
            border-radius:12px;font-size:14px;color:var(--text);
            margin-bottom:14px;outline:none;
        }

        input:focus {
            border-color:var(--accent);
            box-shadow:0 0 0 1px var(--accent);
        }

        .btn-primary {
            width:100%;padding:12px;border:0;
            border-radius:14px;
            background:linear-gradient(135deg,var(--accent),var(--accent-strong));
            color:#022c22;font-weight:700;font-size:14px;
            cursor:pointer;margin-top:6px;
            box-shadow:0 12px 30px rgba(34,197,94,0.35);
        }

        .btn-primary:disabled {
            opacity:0.5;
            cursor:not-allowed;
        }

        .error-box {
            background:rgba(255,82,82,0.15);
            border:1px solid rgba(255,82,82,0.5);
            padding:10px;border-radius:10px;
            font-size:12px;color:#ffbaba;
            margin-bottom:12px;display:none;
            text-align:center;
        }

        .link-row {margin-top:14px;font-size:12px;text-align:center;}
        .link-row a {color:var(--accent);text-decoration:none;}
        .link-row a:hover {text-decoration:underline;}
    </style>
</head>

<body>
    <div class="form-shell">
        <h1>Müşteri Girişi</h1>
        <p class="sub">Telefon numaranız ve şifreniz ile giriş yapın.</p>

        <div id="errorBox" class="error-box"></div>

        <label for="phone">Telefon</label>
        <input type="tel" id="phone" placeholder="05XXXXXXXXX" maxlength="11">

        <label for="password">Şifre</label>
        <input type="password" id="password" placeholder="Şifreniz">

        <button id="loginBtn" class="btn-primary">Giriş Yap</button>

        <div class="link-row">
            Hesabınız yok mu? <a href="customer-register.html">Kayıt Ol</a>
        </div>
    </div>

<script type="module">
    import { firebaseConfig } from "./js/firebase-config.js";

    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { 
        getAuth,
        signInWithEmailAndPassword
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const errorBox = document.getElementById("errorBox");
    const phoneInput = document.getElementById("phone");
    const passInput = document.getElementById("password");
    const btn = document.getElementById("loginBtn");

    function showError(msg){
        errorBox.style.display="block";
        errorBox.textContent = msg;
    }

    btn.addEventListener("click", async ()=>{
        errorBox.style.display="none";
        btn.disabled = true;

        const phone = phoneInput.value.trim();
        const pass = passInput.value.trim();

        if(!phone || !pass){
            btn.disabled = false;
            return showError("Lütfen tüm alanları doldurun.");
        }

        const cleanPhone = phone.replace(/\D/g,"");
        if(!cleanPhone.startsWith("05") || cleanPhone.length !== 11){
            btn.disabled = false;
            return showError("Telefon numarası geçersiz. Format: 05XXXXXXXXX");
        }

        const email = cleanPhone + "@customer.app";

        try{
            await signInWithEmailAndPassword(auth, email, pass);
            window.location.href = "customer-panel.html";
        }catch(err){
            console.error("Giriş hatası:", err);
            if(err.code === "auth/user-not-found"){
                showError("Bu telefon numarasıyla kayıtlı hesap bulunamadı.");
            }else if(err.code === "auth/wrong-password" || err.code === "auth/invalid-credential"){
                showError("Şifre hatalı.");
            }else{
                showError("Giriş yapılamadı: " + err.message);
            }
        }finally{
            btn.disabled = false;
        }
    });
</script>

</body>
</html>

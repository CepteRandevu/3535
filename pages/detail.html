<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>İşletme Detayı</title>

<style>
  body {
    margin: 0;
    background: #e5e9f0;
    font-family: "Segoe UI", Arial, sans-serif;
  }

  .hero {
    position: relative;
    width: 100%;
    height: 200px;
    background: linear-gradient(135deg, #0ea5e9, #6366f1);
    overflow: hidden;
  }

  .cover {
    width: 100%;
    height: 200px;
    object-fit: cover;
    opacity: 0.35;
  }

  .logo-wrap {
    position: absolute;
    left: 50%;
    bottom: -40px;
    transform: translateX(-50%);
    width: 90px;
    height: 90px;
    border-radius: 50%;
    overflow: hidden;
    border: 4px solid #f8fafc;
    box-shadow: 0 5px 20px rgba(15,23,42,0.4);
    background: #e5e7eb;
  }

  .logo {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .content {
    max-width: 550px;
    margin: 60px auto 24px auto;
    padding: 0 16px 20px 16px;
  }

  .name {
    text-align: center;
    font-size: 22px;
    font-weight: 800;
    color: #0f172a;
  }

  .category {
    text-align: center;
    font-size: 14px;
    color: #6366f1;
    margin-top: 4px;
    font-weight: 600;
  }

  .rating {
    margin-top: 6px;
    text-align: center;
    font-size: 14px;
    color: #f59e0b;
    font-weight: 700;
  }

  .pill-row {
    margin-top: 10px;
    display: flex;
    justify-content: center;
    gap: 8px;
    flex-wrap: wrap;
  }

  .pill {
    font-size: 12px;
    padding: 6px 10px;
    border-radius: 999px;
    background: #e0f2fe;
    color: #0f172a;
  }

  .section {
    margin-top: 18px;
    background: #ffffff;
    border-radius: 16px;
    padding: 14px 16px;
    box-shadow: 0 2px 10px rgba(15,23,42,0.12);
  }

  .section-title {
    font-size: 14px;
    font-weight: 700;
    color: #0f172a;
    margin-bottom: 6px;
  }

  .section-text {
    font-size: 14px;
    color: #4b5563;
    line-height: 1.5;
  }

  .row {
    margin-bottom: 6px;
    font-size: 14px;
    color: #4b5563;
  }

  .row b {
    color: #111827;
  }

  .buttons {
    margin-top: 18px;
    display: flex;
    gap: 10px;
  }

  .btn {
    flex: 1;
    padding: 12px;
    border-radius: 999px;
    border: none;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
  }

  .btn-call {
    background: #e5f9f0;
    color: #047857;
  }

  .btn-book {
    background: #0ea5e9;
    color: white;
  }
</style>
</head>
<body>

<div class="hero">
  <img id="coverImg" class="cover" src="">
  <div class="logo-wrap">
    <img id="logoImg" class="logo" src="">
  </div>
</div>

<div class="content">
  <div class="name" id="bizName">İşletme</div>
  <div class="category" id="bizCategory">Kategori</div>
  <div class="rating" id="bizRating">⭐ 0.0</div>

  <div class="pill-row">
    <div class="pill" id="pillCity">İl / İlçe</div>
    <div class="pill" id="pillHours">Çalışma Saatleri</div>
  </div>

  <div class="section">
    <div class="section-title">Adres</div>
    <div class="section-text" id="bizAddress">Adres bilgisi yok.</div>
  </div>

  <div class="section">
    <div class="section-title">İletişim</div>
    <div class="row"><b>Telefon:</b> <span id="bizPhone">-</span></div>
  </div>

  <div class="section">
    <div class="section-title">Hakkında</div>
    <div class="section-text" id="bizAbout">Bu işletme henüz açıklama eklememiş.</div>
  </div>

  <div class="buttons">
    <a id="callBtn" class="btn btn-call" href="#">Ara</a>
    <a id="bookBtn" class="btn btn-book" href="#">Randevu Al</a>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB8jn673zFuYRDhgzFd5yfZ-MP2XSXgyFg",
    authDomain: "cepterandevu-35fe4.firebaseapp.com",
    projectId: "cepterandevu-35fe4",
    storageBucket: "cepterandevu-35fe4.appspot.com",
    messagingSenderId: "86298180836",
    appId: "1:86298180836:web:ab05fbb0dcfbb56b2700f1"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const params = new URLSearchParams(window.location.search);
  const businessId = params.get("id");

  async function loadBusiness() {
    if (!businessId) {
      alert("İşletme bulunamadı.");
      return;
    }

    const ref = doc(db, "businesses", businessId);
    const snap = await getDoc(ref);

    if (!snap.exists()) {
      alert("İşletme kaydı silinmiş veya bulunamadı.");
      return;
    }

    const b = snap.data();

    const name = b.name || "İşletme";
    const category = b.category || "Hizmet";
    const rating = b.rating || "⭐ 0.0";
    const city = b.city || "";
    const district = b.district || "";
    const about = b.about || "Bu işletme henüz açıklama eklememiş.";
    const phone = b.phone || "";
    const address = b.address || "Adres bilgisi eklenmemiş.";
    const openHour = b.openHour || "09:00";
    const closeHour = b.closeHour || "18:00";
    const cover = b.cover || "https://via.placeholder.com/1200x400?text=Isletme+Kapak";
    const logo = b.logo || "https://via.placeholder.com/300x300?text=Logo";

    document.getElementById("coverImg").src = cover;
    document.getElementById("logoImg").src = logo;

    document.getElementById("bizName").innerText = name;
    document.getElementById("bizCategory").innerText = category;
    document.getElementById("bizRating").innerText = rating;

    document.getElementById("pillCity").innerText = city && district ? `${city} / ${district}` : "Lokasyon";
    document.getElementById("pillHours").innerText = `Çalışma: ${openHour} - ${closeHour}`;

    document.getElementById("bizAddress").innerText = address;
    document.getElementById("bizPhone").innerText = phone || "-";
    document.getElementById("bizAbout").innerText = about;

    const callBtn = document.getElementById("callBtn");
    if (phone) {
      callBtn.href = `tel:${phone}`;
    } else {
      callBtn.href = "#";
    }

    // Randevu alma sayfasına gönder
    document.getElementById("bookBtn").href = `booking.html?id=${businessId}`;
  }

  loadBusiness();
</script>

</body>
</html>
